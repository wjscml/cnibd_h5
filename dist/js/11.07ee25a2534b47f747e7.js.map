{"version":3,"sources":["webpack:///src/pages/login/login.vue","webpack:///./src/pages/login/login.vue?54a1","webpack:///./src/pages/login/login.vue"],"names":["login","data","errors","tel","password","isTel","isPsw","isLogining","shareVal","title","document","summary","thumb","mounted","Object","share","this","computed","extends_default","vuex_esm","created","loginState","errorCode","$router","back","isWeiXin","methods","window","navigator","userAgent","toLowerCase","match","checkForm","toLogin","_this","loginParam","mobileNumber","getApi","then","res","push","saveLoginState","history","length","path","errorMessage","catch","error","console","log","_this2","validTel","setTimeout","test","clearTel","close","wxLogin","pageUrl","encodeURIComponent","location","href","components","loading","login_login","render","_vm","_h","$createElement","_c","_self","staticClass","_v","on","click","submit","class","error-input","directives","name","rawName","value","expression","attrs","type","placeholder","domProps","input","$event","target","composing","keyup","_k","keyCode","key","to","tag","ref","_l","index","_s","_e","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"+KAgDAA,GACAC,KADA,WAEA,OACAC,UACAC,IAAA,GACAC,SAAA,GACAC,OAAA,EACAC,OAAA,EACAC,YAAA,EACAC,UACAC,MAAAC,SAAAD,MACAE,QAAA,6DACAC,MAAA,6EAIAC,QAhBA,WAiBAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAR,WAEAS,SAAAC,OACAJ,OAAAK,EAAA,EAAAL,EACA,gBAGAM,QAxBA,WAyBAJ,KAAAK,YA1BA,MA0BAL,KAAAK,WAAAC,WACAN,KAAAO,QAAAC,OAEAR,KAAAS,YAEAC,QAAAR,KACAO,SADA,WAGA,wBADAE,OAAAC,UAAAC,UAAAC,cACAC,MAAA,oBAMA/B,MATA,WAUAgB,KAAAgB,YACAhB,KAAAgB,aACAhB,KAAAiB,WAGAA,QAfA,WAeA,IAAAC,EAAAlB,KACAA,KAAAT,YAAA,EACA,IAAA4B,GACAC,aAAApB,KAAAb,IACAC,SAAAY,KAAAZ,UAEAU,OAAAuB,EAAA,EAAAvB,CAAA,aAAAqB,GAAAG,KAAA,SAAAC,GAEA,GADAL,EAAA3B,YAAA,EArDA,MAsDAgC,EAAAtC,KAAAqB,UAAA,CAGA,GAFAY,EAAAhC,OAAAsC,KAAA,SACAN,EAAAO,eAAAF,EAAAtC,MACA0B,OAAAe,QAAAC,QAAA,EAEA,OADAT,EAAAX,QAAAiB,MAAAI,KAAA,YACA,EAEAV,EAAAX,QAAAC,YAGAU,EAAAhC,OAAAsC,KAAAD,EAAAtC,KAAA4C,gBAEAC,MAAA,SAAAC,GACAC,QAAAC,IAAAF,MAGAf,UAvCA,WAuCA,IAAAkB,EAAAlC,KAcA,OAbAA,KAAAX,OAAA,EACAW,KAAAV,OAAA,EACAU,KAAAb,IAGAa,KAAAmC,SAAAnC,KAAAb,OACAa,KAAAd,OAAAsC,KAAA,cACAxB,KAAAX,OAAA,IAJAW,KAAAd,OAAAsC,KAAA,WACAxB,KAAAX,OAAA,GAKAW,KAAAZ,WACAY,KAAAd,OAAAsC,KAAA,SACAxB,KAAAV,OAAA,IAEAU,KAAAd,OAAAyC,SAGAS,WAAA,WACAF,EAAAhD,WACA,MACA,IAGAiD,SA9DA,SA8DAhD,GAEA,MADA,cACAkD,KAAAlD,IAEAmD,SAlEA,WAmEAtC,KAAAb,IAAA,IAEAoD,MArEA,WAsEAvC,KAAAO,QAAAiB,MAAAI,KAAA,aAEA9B,OAAAK,EAAA,EAAAL,EACA,oBAEA0C,QA3EA,WA4EA,IAAAC,EAAAC,mBAAA,kCACA1C,KAAAS,WACAE,OAAAgC,SAAAC,KAAA,6FAAAH,EAAA,2FAEA9B,OAAAgC,SAAAC,KAAA,sFAAAH,EAAA,wEAIAI,YACAC,UAAA,IChKAC,GADiBC,OAFjB,WAA0B,IAAAC,EAAAjD,KAAakD,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,UAAoBF,EAAA,OAAYE,YAAA,kBAA4BF,EAAA,UAAeE,YAAA,iBAA2BF,EAAA,QAAaE,YAAA,UAAoBL,EAAAM,GAAA,SAAAN,EAAAM,GAAA,KAAAH,EAAA,OAAwCE,YAAA,YAAAE,IAA4BC,MAAAR,EAAAV,SAAmBa,EAAA,KAAUE,YAAA,mBAAyBL,EAAAM,GAAA,KAAAH,EAAA,QAA6BE,YAAA,aAAAE,IAA6BE,OAAAT,EAAAjC,aAAwBoC,EAAA,OAAYE,YAAA,kBAA4BF,EAAA,OAAYE,YAAA,gBAAAK,OAAmCC,cAAAX,EAAA5D,SAA0B+D,EAAA,SAAcS,aAAaC,KAAA,QAAAC,QAAA,UAAAC,MAAAf,EAAA,IAAAgB,WAAA,QAAgEC,OAASC,KAAA,OAAAC,YAAA,UAAqCC,UAAWL,MAAAf,EAAA,KAAkBO,IAAKc,MAAA,SAAAC,GAAyBA,EAAAC,OAAAC,YAAsCxB,EAAA9D,IAAAoF,EAAAC,OAAAR,WAA8Bf,EAAAM,GAAA,KAAAH,EAAA,KAAsBS,aAAaC,KAAA,OAAAC,QAAA,SAAAC,MAAAf,EAAA,IAAAgB,WAAA,QAA8DX,YAAA,eAAAE,IAAiCC,MAAAR,EAAAX,cAAsBW,EAAAM,GAAA,KAAAH,EAAA,OAA0BE,YAAA,gBAAAK,OAAmCC,cAAAX,EAAA3D,SAA0B8D,EAAA,SAAcS,aAAaC,KAAA,QAAAC,QAAA,UAAAC,MAAAf,EAAA,SAAAgB,WAAA,aAA0EC,OAASC,KAAA,WAAAC,YAAA,SAAwCC,UAAWL,MAAAf,EAAA,UAAuBO,IAAKkB,MAAA,SAAAH,GAAyB,iBAAAA,IAAAtB,EAAA0B,GAAAJ,EAAAK,QAAA,WAAAL,EAAAM,IAAA,SAA+F5B,EAAAjE,MAAAuF,GAAf,MAAwCD,MAAA,SAAAC,GAA0BA,EAAAC,OAAAC,YAAsCxB,EAAA7D,SAAAmF,EAAAC,OAAAR,eAAmCf,EAAAM,GAAA,KAAAH,EAAA,OAA4BE,YAAA,SAAAE,IAAyBC,MAAAR,EAAAjE,SAAmBiE,EAAAM,GAAA,QAAAN,EAAAM,GAAA,KAAAH,EAAA,OAAuCE,YAAA,eAAyBF,EAAA,eAAoBc,OAAOY,GAAA,YAAAC,IAAA,UAA+B9B,EAAAM,GAAA,UAAAN,EAAAM,GAAA,KAAAH,EAAA,eAAiDc,OAAOY,GAAA,UAAAC,IAAA,UAA6B9B,EAAAM,GAAA,cAAAN,EAAAM,GAAA,KAAAH,EAAA,cAAoDc,OAAOJ,KAAA,WAAgBb,EAAA/D,OAAA,OAAAkE,EAAA,OAAgC4B,IAAA,eAAA1B,YAAA,iBAA+CL,EAAAgC,GAAAhC,EAAA,gBAAAlB,EAAAmD,GAA2C,UAAAA,EAAA9B,EAAA,KAA4ByB,IAAAK,EAAA5B,YAAA,eAAmCL,EAAAM,GAAAN,EAAAkC,GAAApD,MAAAkB,EAAAmC,QAAmCnC,EAAAmC,QAAA,KAAAnC,EAAAM,GAAA,KAAAH,EAAA,OAA0CE,YAAA,aAAuBF,EAAA,KAAUE,YAAA,cAAAE,IAA8BC,MAAAR,EAAAT,WAAqBS,EAAAM,GAAA,KAAAH,EAAA,KAAAH,EAAAM,GAAA,YAAAN,EAAAM,GAAA,KAAAN,EAAA,WAAAG,EAAA,OAAgFE,YAAA,eAAyBF,EAAA,WAAgBE,YAAA,gBAAAY,OAAmCzE,MAAA,cAAmB,GAAAwD,EAAAmC,QAEhzEC,oBCCjB,IAcAC,EAdAC,EAAA,OAcAC,CACAxG,EACA+D,GATA,EAVA,SAAA0C,GACAF,EAAA,SAaA,KAEA,MAUAG,EAAA,QAAAJ,EAAA","file":"js/11.07ee25a2534b47f747e7.js","sourcesContent":["<template>\n  <div class=\"login\">\n    <div class=\"login-wrapper\">\n      <header class=\"login-header\">\n        <span class=\"title\">登 录</span>\n        <div class=\"btn-close\" @click=\"close\">\n          <i class=\"icon-close\"></i>\n        </div>\n      </header>\n      <form class=\"login-form\" @submit=\"checkForm\">\n        <div class=\"login-content\">\n          <div class=\"input-wrapper\" :class=\"{'error-input': isTel}\">\n            <input v-model=\"tel\" type=\"text\" placeholder=\"请输入手机号\">\n            <i @click=\"clearTel\" v-show=\"tel\" class=\"icon-dismiss\"></i>\n          </div>\n          <div class=\"input-wrapper\" :class=\"{'error-input': isPsw}\">\n            <input v-model=\"password\" type=\"password\" placeholder=\"请输入密码\" @keyup.enter=\"login\">\n          </div>\n        </div>\n        <div class=\"submit\" @click=\"login\">登录</div>\n        <div class=\"login-tips\">\n          <router-link to=\"/register\" tag=\"span\">立即注册</router-link>\n          <router-link to=\"/forget\" tag=\"span\">忘记密码</router-link>\n        </div>\n        <transition name=\"error\">\n          <div class=\"error-wrapper\" v-if=\"errors.length\" ref=\"errorWrapper\">\n            <p class=\"error-text\" v-for=\"(error, index) in errors\" :key=\"index\" v-if=\"index == 0\">{{error}}</p>\n          </div>\n        </transition>\n      </form>\n    </div>\n    <div class=\"login-wx\">\n      <i class=\"icon-weixin\" @click=\"wxLogin\"></i>\n      <p>微信登录</p>\n    </div>\n    <div class=\"login-mask\" v-if=\"isLogining\">\n      <loading class=\"login-loading\" :title=\"'正在登录...'\"></loading>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Loading from '../../components/loading/loading.vue'\nimport {postApi} from '../../api/getApi.js'\nimport {mapActions, mapGetters} from 'vuex'\nimport {share} from '../../common/js/share.js'\n\nconst ERR_OK = '0'\nexport default {\n  data () {\n    return {\n      errors: [],\n      tel: '',\n      password: '',\n      isTel: false,\n      isPsw: false,\n      isLogining: false,\n      shareVal: {\n        title: document.title,\n        summary: '赛恩财经，提供全球股票、外汇、期货、债券、基金和数字货币等数十万种金融投资产品的实时行情和新闻资讯以及多种投资工具。',\n        thumb: 'https://cnibd.oss-cn-beijing.aliyuncs.com/resource/images/sharelogo.png'\n      }\n    }\n  },\n  mounted () {\n    share(this.shareVal)\n  },\n  computed: {\n    ...mapGetters([\n      'loginState'\n    ])\n  },\n  created () {\n    if (this.loginState && this.loginState.errorCode === ERR_OK) {\n      this.$router.back()\n    }\n    this.isWeiXin()\n  },\n  methods: {\n    isWeiXin () {\n      let ua = window.navigator.userAgent.toLowerCase()\n      if (ua.match(/MicroMessenger/i) == 'micromessenger') {//eslint-disable-line\n        return true\n      } else {\n        return false\n      }\n    },\n    login () {\n      this.checkForm()\n      if (this.checkForm()) {\n        this.toLogin()\n      }\n    },\n    toLogin () {\n      this.isLogining = true\n      let loginParam = {\n        mobileNumber: this.tel,\n        password: this.password\n      }\n      postApi('user.login', loginParam).then(res => {\n        this.isLogining = false\n        if (res.data.errorCode === ERR_OK) {\n          this.errors.push('成功登陆！')\n          this.saveLoginState(res.data)\n          if (window.history.length <= 1) {\n            this.$router.push({path: '/index'})\n            return false\n          } else {\n            this.$router.back()\n          }\n        } else {\n          this.errors.push(res.data.errorMessage)\n        }\n      }).catch(error => {\n        console.log(error)\n      })\n    },\n    checkForm () {\n      this.isTel = false\n      this.isPsw = false\n      if (!this.tel) {\n        this.errors.push('请输入手机号码')\n        this.isTel = true\n      } else if (!this.validTel(this.tel)) {\n        this.errors.push('请输入正确的手机号码')\n        this.isTel = true\n      }\n      if (!this.password) {\n        this.errors.push('请输入密码')\n        this.isPsw = true\n      }\n      if (!this.errors.length) {\n        return true\n      } else {\n        setTimeout(() => {\n          this.errors = []\n        }, 4000)\n        return false\n      }\n    },\n    validTel (tel) {\n      var re = /^[0-9]{11}$/\n      return re.test(tel)\n    },\n    clearTel () {\n      this.tel = ''\n    },\n    close () {\n      this.$router.push({path: '/index'})\n    },\n    ...mapActions([\n      'saveLoginState'\n    ]),\n    wxLogin () {\n      let pageUrl = encodeURIComponent('https://www.cnibd.com/wx_login')\n      if (this.isWeiXin()) {\n        window.location.href = 'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxb5b03bf29736518a&redirect_uri=' + pageUrl + '&response_type=code&scope=snsapi_userinfo&state=STATE&connect_redirect=1#wechat_redirect'\n      } else {\n        window.location.href = 'https://open.weixin.qq.com/connect/qrconnect?appid=wx70d395942c321a44&redirect_uri=' + pageUrl + '&response_type=code&scope=snsapi_login&state=STATE#wechat_redirect'\n      }\n    }\n  },\n  components: {\n    'loading': Loading\n  }\n}\n</script>\n\n<style lang=\"stylus\">\n@import \"../../common/stylus/mixin.styl\"\n.login\n  display flex\n  flex-direction column\n  justify-content space-between\n  position fixed\n  top 0\n  bottom 0\n  left 0\n  right 0\n  width 100%\n  background-color #fff\n  .login-wrapper\n    .login-header\n      display flex\n      align-items center\n      padding 0 2rem 0 4.5rem\n      height 5rem\n      text-align center\n      background-color #1f8bee\n      color #fff\n      .title\n        flex 1\n        font-size 2rem\n      .btn-close\n        extend-click()\n        font-size 0\n        .icon-close\n          font-size 2.5rem\n    .login-form\n      position relative\n      padding 3rem 2rem 0\n      .login-content\n        margin-bottom 7rem\n        .input-wrapper\n          display flex\n          align-items center\n          margin-bottom 1rem\n          padding 1.6rem 0\n          font-size 0\n          border-bottom 1px solid rgba(7,17,27,0.1)\n          &.error-input\n            border-bottom-color #f1403c\n          input\n            vertical-align top\n            font-size 1.6rem\n            width 100%\n            outline none\n            border none\n            color #393a4c\n            caret-color #1f8bee\n          .icon-dismiss\n            width 2.2rem\n            font-size 1.8rem\n            text-align center\n            color #bfbfbf\n      .login-tips\n        padding 1.4rem 0.4rem\n        display flex\n        align-items center\n        justify-content space-between\n        span\n          font-size 1.4rem\n          color #393a4c\n      .submit\n        width 100%\n        outline none\n        border none\n        height 4rem\n        line-height 4rem\n        font-size 1.7rem\n        border-radius .4rem\n        background-color #1f8bee\n        color #fff\n        text-align center\n      .error-wrapper\n        position absolute\n        top -1rem\n        left 0\n        width 100%\n        opacity 0\n        .error-text\n          margin 0 2rem\n          height 4rem\n          line-height 4rem\n          border-radius .4rem\n          text-align center\n          color #fff\n          background-color #f1403c\n        &.error-enter-active\n          animation show-error 4s ease\n  .login-wx\n    margin-bottom 4rem\n    width 100%\n    text-align center\n    .icon-weixin\n      font-size 5rem\n      color #04be02\n    p\n      font-size 1.4rem\n      color #393a4c\n  .login-mask\n    position fixed\n    top 0\n    bottom 0\n    left 0\n    right 0\n    background-color rgba(7,17,27,0.9)\n    .login-loading\n      margin-top 50%\n@keyframes show-error\n  0%\n    opacity 0\n  25%\n    opacity 1\n  75%\n    opacity 1\n  100%\n    opacity 0\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/pages/login/login.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"login\"},[_c('div',{staticClass:\"login-wrapper\"},[_c('header',{staticClass:\"login-header\"},[_c('span',{staticClass:\"title\"},[_vm._v(\"登 录\")]),_vm._v(\" \"),_c('div',{staticClass:\"btn-close\",on:{\"click\":_vm.close}},[_c('i',{staticClass:\"icon-close\"})])]),_vm._v(\" \"),_c('form',{staticClass:\"login-form\",on:{\"submit\":_vm.checkForm}},[_c('div',{staticClass:\"login-content\"},[_c('div',{staticClass:\"input-wrapper\",class:{'error-input': _vm.isTel}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.tel),expression:\"tel\"}],attrs:{\"type\":\"text\",\"placeholder\":\"请输入手机号\"},domProps:{\"value\":(_vm.tel)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.tel=$event.target.value}}}),_vm._v(\" \"),_c('i',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.tel),expression:\"tel\"}],staticClass:\"icon-dismiss\",on:{\"click\":_vm.clearTel}})]),_vm._v(\" \"),_c('div',{staticClass:\"input-wrapper\",class:{'error-input': _vm.isPsw}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.password),expression:\"password\"}],attrs:{\"type\":\"password\",\"placeholder\":\"请输入密码\"},domProps:{\"value\":(_vm.password)},on:{\"keyup\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.login($event)},\"input\":function($event){if($event.target.composing){ return; }_vm.password=$event.target.value}}})])]),_vm._v(\" \"),_c('div',{staticClass:\"submit\",on:{\"click\":_vm.login}},[_vm._v(\"登录\")]),_vm._v(\" \"),_c('div',{staticClass:\"login-tips\"},[_c('router-link',{attrs:{\"to\":\"/register\",\"tag\":\"span\"}},[_vm._v(\"立即注册\")]),_vm._v(\" \"),_c('router-link',{attrs:{\"to\":\"/forget\",\"tag\":\"span\"}},[_vm._v(\"忘记密码\")])],1),_vm._v(\" \"),_c('transition',{attrs:{\"name\":\"error\"}},[(_vm.errors.length)?_c('div',{ref:\"errorWrapper\",staticClass:\"error-wrapper\"},_vm._l((_vm.errors),function(error,index){return (index == 0)?_c('p',{key:index,staticClass:\"error-text\"},[_vm._v(_vm._s(error))]):_vm._e()})):_vm._e()])],1)]),_vm._v(\" \"),_c('div',{staticClass:\"login-wx\"},[_c('i',{staticClass:\"icon-weixin\",on:{\"click\":_vm.wxLogin}}),_vm._v(\" \"),_c('p',[_vm._v(\"微信登录\")])]),_vm._v(\" \"),(_vm.isLogining)?_c('div',{staticClass:\"login-mask\"},[_c('loading',{staticClass:\"login-loading\",attrs:{\"title\":'正在登录...'}})],1):_vm._e()])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/.13.7.2@vue-loader/lib/template-compiler?{\"id\":\"data-v-0f51a72a\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/.13.7.2@vue-loader/lib/selector.js?type=template&index=0!./src/pages/login/login.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/.3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/.13.7.2@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-0f51a72a\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../node_modules/.13.7.2@vue-loader/lib/selector?type=styles&index=0!./login.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/.13.7.2@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/.13.7.2@vue-loader/lib/selector?type=script&index=0!./login.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/.13.7.2@vue-loader/lib/selector?type=script&index=0!./login.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/.13.7.2@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-0f51a72a\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/.13.7.2@vue-loader/lib/selector?type=template&index=0!./login.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/login/login.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}