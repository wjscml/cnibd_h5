webpackJsonp([14],{"AsU/":function(t,s){},kkNY:function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var o=a("34v0"),i=a.n(o),e=a("h2NJ"),r=a("bh5B"),n=a("A2FV"),l=a("tL1G"),c=a("/gb8"),h=a("dyDs"),u=a("EcfS"),f={data:function(){return{news:[],authorInfo:[],page:0,tips:"上滑加载更多",isLoad:null,scrollY:0,isScrollTop:null,shareVal:{},confirmText:""}},computed:i()({},Object(u.c)(["author","loginState"])),mounted:function(){},created:function(){this.direction="horizontal",this.probeType=3,this.listenScroll=!0,this.pullUpLoad=!0,this._getAuthor()},methods:{loadTop:function(){this.$refs.list.refresh()},_getAuthor:function(){this.loginState&&"0"===this.loginState.errorCode?(this.params={authorId:this.$route.params.id,page:0,session:this.loginState.data.data.session},this.getAuthor()):(this.params={authorId:this.$route.params.id,page:0},this.getAuthor())},getAuthor:function(){var t=this;Object(c.b)("user.authorPublish",this.params).then(function(s){"0"===s.data.errorCode?(t.authorInfo=s.data.data.userInfo,t.$nextTick(function(){t.topHeight=t.$refs.top.clientHeight,t.barHeight=t.$refs.bar.clientHeight,t.minTranslateY=t.barHeight-t.topHeight,t.$refs.list.$el.style.top=t.topHeight+"px"}),t.news=s.data.data.publishArticles,t.shareVal.title=t.authorInfo.nickname,t.shareVal.summary=t.authorInfo.description,t.shareVal.thumb=t.authorInfo.avatar,Object(h.a)(t.shareVal)):(t.authorInfo=t.author,t.tips="暂未发表文章")}).catch(function(s){s.res||(t.tips="网络不给力，请稍后重试")})},loadMore:function(){var t=this;this.tips="正在加载...",this.isLoad=!0,this.page++;var s={authorId:this.$route.params.id,page:this.page};Object(c.b)("user.authorPublish",s).then(function(s){"0"===s.data.errorCode?(t.news=t.news.concat(s.data.data.publishArticles),t.tips="上滑加载更多",t.isLoad=!1):(t.tips="没有更多数据了~",t.isLoad=!1)}).catch(function(s){s.res||(t.tips="网络不给力，请稍后重试")})},back:function(){if(window.history.length<=1)return this.$router.push({path:"/columnist"}),!1;this.$router.back()},scroll:function(t){this.scrollY=t.y},touchToEnd:function(){this.loadMore()},toggleFavorite:function(){var t=this;this.loginState&&"0"===this.loginState.errorCode?Object(c.b)("user.follow",{session:this.loginState.data.data.session,followUserId:this.$route.params.id}).then(function(s){1===s.data.data.action&&(t.authorInfo.is_follow=1),2===s.data.data.action&&(t.authorInfo.is_follow=0)}):this.showConfirm()},showConfirm:function(){this.loginState&&"0"===this.loginState.errorCode?this.confirmText="是否不再关注此作者":this.confirmText="登录后方可关注作者",this.$refs.confirm.show()},confirmOK:function(){this.loginState&&"0"===this.loginState.errorCode?this.toggleFavorite():this.$router.push("/login")}},watch:{scrollY:function(t){var s=Math.max(this.minTranslateY,t);this.$refs.layer.style.transform="translate3d(0, "+s+"px, 0)",t>this.minTranslateY?this.isScrollTop=!1:this.isScrollTop=!0;var a=1,o=Math.abs(t/this.topHeight);t>0&&(a=1+o),this.$refs.bgImage.style.transform="scale("+a+")";var i=this.topHeight*a;this.$refs.top.style.height=i+"px"}},components:{"news-column":n.a,"load-tips":l.a,scroll:r.a,confirm:e.a}},d={render:function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("transition",{attrs:{name:"slide"}},[a("div",{directives:[{name:"wechat-title",rawName:"v-wechat-title",value:t.authorInfo.nickname,expression:"authorInfo.nickname"}],staticClass:"columnist-author"},[a("div",{ref:"top",staticClass:"top-wrapper"},[a("div",{staticClass:"avatar",class:{vip:1===t.authorInfo.is_certificate}},[a("img",{staticClass:"image",attrs:{src:t.authorInfo.avatar},on:{load:t.loadTop}})]),t._v(" "),a("div",{staticClass:"text"},[a("h1",{staticClass:"name"},[t._v(t._s(t.authorInfo.nickname))]),t._v(" "),a("p",{staticClass:"intro"},[t._v(t._s(t.authorInfo.description))])]),t._v(" "),a("div",{staticClass:"focus"},[t.authorInfo.is_follow?t._e():a("div",{staticClass:"focus-content bg-red",on:{click:t.toggleFavorite}},[a("i",{staticClass:"icon-add"}),a("span",[t._v("关 注")])]),t._v(" "),a("transition",{attrs:{name:"focus"}},[t.authorInfo.is_follow?a("div",{staticClass:"focus-content",on:{click:t.showConfirm}},[a("i",{staticClass:"icon-check"}),a("span",[t._v("已关注")])]):t._e()])],1),t._v(" "),a("div",{ref:"bar",staticClass:"back",on:{click:t.back}},[a("i",{staticClass:"icon-back",class:{"icon-back-black":t.isScrollTop}})]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isScrollTop,expression:"isScrollTop"}],staticClass:"title"},[t._v(t._s(t.authorInfo.nickname))]),t._v(" "),a("div",{ref:"bgImage",staticClass:"background"},[a("img",{attrs:{src:t.authorInfo.avatar}})])]),t._v(" "),a("div",{ref:"layer",staticClass:"bg-layer"}),t._v(" "),a("scroll",{ref:"list",staticClass:"list",attrs:{data:t.news,pullUpLoad:t.pullUpLoad,probeType:t.probeType,listenScroll:t.listenScroll},on:{scroll:t.scroll,touchToEnd:t.touchToEnd}},[a("div",[a("news-column",{staticClass:"news-column",attrs:{news:t.news}}),t._v(" "),t.news.length?a("load-tips",{attrs:{tips:t.tips,isLoad:t.isLoad}}):t._e()],1)]),t._v(" "),a("confirm",{ref:"confirm",attrs:{text:t.confirmText},on:{confirm:t.confirmOK}})],1)])},staticRenderFns:[]};var p=a("D8HT")(f,d,!1,function(t){a("AsU/")},null,null);s.default=p.exports}});
//# sourceMappingURL=14.8c6c25f2c600a2fe21c7.js.map